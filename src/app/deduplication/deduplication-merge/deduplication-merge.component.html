<div class="container">
  <div class="row">
    <div class="col-12">
      <h2 id="header" class="border-bottom pb-2">
        {{ "Merge Deduplications" | translate }}
      </h2>

      <div class="col-md-12 text-center" *ngIf="itemsToCompare.length == 0">
        <h4 class="p-3">
          {{ "no-data" | translate }}
        </h4>
      </div>

      <!-- <ds-loading class="container" *ngIf="isSetsLoading() | async"
        [message]="'deduplication.sets.message.loading' | translate"></ds-loading> -->

      <p>Records to compare</p>

      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">Entities</th>
            <th scope="col">Identifier</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="itemsToCompare">
            <tr *ngFor="let itemObj of itemsToCompare">
              <td>
                {{ (itemObj.object$ | async)?.name }}
              </td>
              <td>
                <span *ngIf="itemObj.color" [ngStyle]="{ color: itemObj.color }">
                  ({{ (itemObj.object$ | async)?.uuid }})
                </span>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
      <ng-container *ngIf="itemsToCompare.length > 0">
        <ngb-accordion [destroyOnHide]="false" [closeOthers]="true" activeIds="panel-0" *ngFor="
            let keyvalue of (itemsToCompare[0].object$ | async)?.metadata
              | keyvalue
          ">
          <ngb-panel id="panel-{{ 0 }}">
            <ng-template ngbPanelHeader let-opened="opened">
              <div class="row">
                <div class="col-md-10 mt-1 uppercase">
                  {{ keyvalue.key }}
                </div>
                <div class="col-md-2 text-right mt-1">
                  <button ngbPanelToggle class="btn btn-sm" [ngClass]="opened ? 'btn-info' : 'btn-outline-info'">
                    <i *ngIf="!opened" class="fa fa-chevron-up"></i>
                    <i *ngIf="opened" class="fa fa-chevron-down"></i>
                  </button>
                </div>
              </div>
            </ng-template>
            <ng-template ngbPanelContent>
              <ng-container *ngFor="let itemObj of itemsToCompare; let i = index">
                <ng-container *ngFor="
                    let data of (itemObj.object$ | async)?.metadata[
                      keyvalue.key
                    ]
                  ">

                  <div class="row item-container" *ngIf="itemObj.color"
                    [ngStyle]="{ 'background-color': itemObj.color }">
                    <div class="col-1">
                      <input type="checkbox" name="" id="">
                    </div>
                    <span class="col-6">
                      {{ data.value }}
                    </span>
                    <span class="col-5 justify-content-end">
                      ({{ (itemObj.object$ | async)?.uuid }})
                    </span>
                  </div>
                </ng-container>
              </ng-container>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>
      </ng-container>
    </div>
  </div>
</div>
